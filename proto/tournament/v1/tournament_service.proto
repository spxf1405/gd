syntax = "proto3";

package tournament.v1;

import "tournament/v1/tournament.proto";
import "google/protobuf/empty.proto";
import "buf/validate/validate.proto";

option go_package = "backend/internal/gen/tournament/v1;tournamentpb";

enum TournamentFilterBy {
  TOURNAMENT_FILTER_BY_UNSPECIFIED = 0;
  TOURNAMENT_FILTER_BY_NAME        = 1;
  TOURNAMENT_FILTER_BY_TYPE        = 2;
  TOURNAMENT_FILTER_BY_FORMAT      = 3;
  TOURNAMENT_FILTER_BY_LOCATION    = 4;
  TOURNAMENT_FILTER_BY_START_DATE  = 5;
  TOURNAMENT_FILTER_BY_STATUS      = 6;
}

enum TournamentSortBy {
  TOURNAMENT_SORT_BY_UNSPECIFIED = 0;
  TOURNAMENT_SORT_BY_CREATED_AT  = 1;
  TOURNAMENT_SORT_BY_START_DATE  = 2;
  TOURNAMENT_SORT_BY_END_DATE    = 3;
  TOURNAMENT_SORT_BY_TOTAL_PRIZE = 4;
  TOURNAMENT_SORT_BY_NAME        = 5;
}

enum SortOrder {
  SORT_ORDER_UNSPECIFIED = 0;
  SORT_ORDER_ASC         = 1;
  SORT_ORDER_DESC        = 2;
}

enum FilterOperator {
  FILTER_MATCH_TYPE_UNSPECIFIED = 0;
  EQ                            = 1;
  NEQ                           = 2;
  CONTAINS                      = 3;
  NOT_CONTAINS                  = 4;
  STARTS_WITH                   = 5;
  ENDS_WITH                     = 6;
  GT                            = 7;
  GTE                           = 8;
  LT                            = 9;
  LTE                           = 10;
  BETWEEN                       = 11;
  IS_NULL                       = 12;
  IS_NOT_NULL                   = 13;
  SET                           = 14;
}

message StringList {
  repeated string values = 1;
}

message Int32List {
  repeated int32 values = 1;
}

message FilterValue {
  oneof kind {
    string     string_value = 1;
    StringList string_list  = 2;
    Int32List  int32_list   = 3;
  }
}

message Filter {
  TournamentFilterBy filter_by       = 1;
  FilterOperator     filter_operator = 2;
  FilterValue        value           = 3;
}

message GetTournamentsRequest {
  int32            page       = 1 [(buf.validate.field).int32.gt = 0];
  int32            limit      = 2 [(buf.validate.field).int32.gt = 0];
  repeated Filter  filters    = 3;
  TournamentSortBy sort_by    = 4;
  SortOrder        sort_order = 5;
}

message GetTournamentsResponse {
  repeated Tournament tournaments = 1;
}

message GetTournamentsRequestWrapper {
  oneof request {
    google.protobuf.Empty empty = 1;
    GetTournamentsRequest query = 2;
  }
}

message CreateTournamentRequest {
  string name = 1;
}

message CreateTournamentResponse {
  string id = 1;
}

service TournamentService {
  rpc GetTournaments(GetTournamentsRequestWrapper) returns (GetTournamentsResponse);
  rpc CreateTournament(CreateTournamentRequest) returns (CreateTournamentResponse);
}
