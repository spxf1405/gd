syntax = "proto3";

package tournament.v1;

import "tournament/v1/tournament.proto";
import "google/protobuf/empty.proto";
import "buf/validate/validate.proto";

option go_package = "backend/internal/gen/tournament/v1;tournamentpb";

enum TournamentFilterBy {
  TOURNAMENT_FILTER_BY_UNSPECIFIED = 0;

  TOURNAMENT_FILTER_BY_NAME        = 1; // name
  TOURNAMENT_FILTER_BY_TYPE        = 2; // type
  TOURNAMENT_FILTER_BY_FORMAT      = 3; // format
  TOURNAMENT_FILTER_BY_LOCATION    = 4; // location
  TOURNAMENT_FILTER_BY_START_DATE  = 5; // startDate
  TOURNAMENT_FILTER_BY_TOTAL_PRIZE = 6; // totalPrize
  TOURNAMENT_FILTER_BY_STATUS      = 7; // status
}

enum TournamentSortBy {
  TOURNAMENT_SORT_BY_UNSPECIFIED = 0;

  TOURNAMENT_SORT_BY_CREATED_AT  = 1; // createdAt (default)
  TOURNAMENT_SORT_BY_START_DATE  = 2; // startDate
  TOURNAMENT_SORT_BY_END_DATE    = 3; // endDate
  TOURNAMENT_SORT_BY_TOTAL_PRIZE = 4; // totalPrize
  TOURNAMENT_SORT_BY_NAME        = 5; // name
}

enum SortOrder {
  SORT_ORDER_UNSPECIFIED = 0;
  SORT_ORDER_ASC         = 1;
  SORT_ORDER_DESC        = 2;
}

enum FilterMatchType {
  FILTER_MATCH_TYPE_UNSPECIFIED = 0;
  EQ                            = 1;
  NEQ                           = 2;
  CONTAINS                      = 3;
  NOT_CONTAINS                  = 4;
  STARTS_WITH                   = 5;
  ENDS_WITH                     = 6;
  GT                            = 7;
  GTE                           = 8;
  LT                            = 9;
  LTE                           = 10;
  BETWEEN                       = 11;
  IS_NULL                       = 12;
  IS_NOT_NULL                   = 13;
}

// Request for listing tournaments with pagination, filtering, and sorting.
message GetTournamentsRequest {
  int32              page         = 1 [(buf.validate.field).int32.gt = 0]; // Page number (1-based)
  int32              limit        = 2 [(buf.validate.field).int32.gt = 0]; // Page size
  string             filter       = 3; // Filter value
  TournamentFilterBy filter_by    = 4; // Field name to filter on
  FilterMatchType    filter_model = 5; // Match type (contains, equals, etc.)
  TournamentSortBy   sort_by      = 6; // Field name to sort by
  SortOrder          sort_order   = 7; // Sort order (asc or desc)
}

// Response containing a list of tournaments.
message GetTournamentsResponse {
  repeated Tournament tournaments = 1; // Tournament list
}

// Wrapper allowing empty request or filtered request.
message GetTournamentsRequestWrapper {
  oneof request {
    google.protobuf.Empty empty  = 1; // Fetch all tournaments with defaults
    GetTournamentsRequest filter = 2; // Fetch tournaments with filters
  }
}

// Request for creating a new tournament.
message CreateTournamentRequest {
  string name = 1; // Tournament name
}

// Response after creating a tournament.
message CreateTournamentResponse {
  string id = 1; // Created tournament ID
}

// Tournament service definition.
service TournamentService {
  // Returns a paginated list of tournaments.
  rpc GetTournaments(GetTournamentsRequestWrapper) returns (GetTournamentsResponse);
  // Creates a new tournament.
  rpc CreateTournament(CreateTournamentRequest) returns (CreateTournamentResponse);
}
